<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Product | Sunny Sugar Art</title>
<style>
  :root{
    --ink:#1f1b14; --muted:#6b5f4a; --line:#efe5c9;
    --pill:#4b3a2b; --pill-ink:#fff;
  }
  *{box-sizing:border-box}
  body{margin:0;font:16px/1.7 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink);background:#fff}
  a{color:inherit;text-decoration:none}
  header{padding:18px 20px;border-bottom:1px solid var(--line)}
  header a{font-weight:900}

  .wrap{max-width:1200px;margin:0 auto;padding:24px}
  .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:28px}
  @media (max-width:980px){.grid{grid-template-columns:1fr}}
  h1{margin:0 0 6px}
  .price{font-weight:900;margin:6px 0 18px;font-size:1.2rem}

  /* 圖片區：左側直立縮圖 + 中間大圖 */
  .gallery{display:grid;grid-template-columns:88px 1fr;gap:12px}
  .thumbs{display:flex;flex-direction:column;gap:8px;max-height:560px;overflow:auto;padding-right:2px}
  .thumbs img{width:88px;height:88px;object-fit:cover;border-radius:10px;border:2px solid transparent;cursor:pointer;display:block;background:#f7f4ee}
  .thumbs img[aria-current="true"]{border-color:#111}
  .stage{position:relative;border:1px solid #f2ecd7;border-radius:14px;overflow:hidden;background:#f7f4ee;height:560px}
  .stage img{width:100%;height:100%;object-fit:cover;display:block}
  .nav{position:absolute;top:50%;transform:translateY(-50%);background:#fff;border:0;border-radius:50%;width:40px;height:40px;cursor:pointer;box-shadow:0 6px 16px rgba(0,0,0,.12)}
  .nav.prev{left:10px}.nav.next{right:10px}

  /* 表單 */
  label{display:block;margin:12px 0 8px;font-weight:800}
  select,button{font:inherit}
  select{width:100%;padding:10px 12px;border:1px solid #e9e1c7;border-radius:10px;background:#fff}
  .swatches{display:flex;gap:10px;flex-wrap:wrap}
  .swatch{width:34px;height:34px;border-radius:10px;border:2px solid transparent;cursor:pointer}
  .swatch[aria-pressed="true"]{outline:2px solid #111;outline-offset:2px}
  .swatch.pink{background:#f472b6}.swatch.orange{background:#fb923c}.swatch.black{background:#111}.swatch.white{background:#fff;border-color:#e5e1d0}.swatch.gold{background:linear-gradient(135deg,#f59e0b,#facc15)}.swatch.red{background:#ef4444}.swatch.green{background:#10b981}.swatch.blue{background:#3b82f6}.swatch.purple{background:#8b5cf6}.swatch.brown{background:#8b5e3c}.swatch.yellow{background:#fde047}
  .btn{display:inline-block;margin-top:16px;background:#fff;border:2px solid var(--pill);color:var(--pill);padding:12px 18px;border-radius:999px;font-weight:900}
  .btn.primary{background:var(--pill);color:var(--pill-ink)}
  .note{margin-top:16px;font-size:.9rem;color:var(--muted)}
  .oops{padding:18px;border:1px solid #ffd1cd;background:#fff3f2;border-radius:12px}
</style>
</head>
<body>
<header><a href="javascript:history.back()">← Back</a></header>

<div class="wrap" id="app">
  <div class="grid" id="grid" style="display:none">
    <!-- 圖片 -->
    <section>
      <div class="gallery">
        <div class="thumbs" id="thumbs"></div>
        <div class="stage">
          <img id="hero" alt="Product image">
          <button class="nav prev" id="prev" aria-label="Previous image">‹</button>
          <button class="nav next" id="next" aria-label="Next image">›</button>
        </div>
      </div>
    </section>

    <!-- 表單 -->
    <aside>
      <h1 id="title">Loading...</h1>
      <div id="price" class="price"></div>

      <form id="buy">
        <label>Flavour
          <select id="flavour"></select>
        </label>

        <label>Pack Size
          <select id="pack"></select>
        </label>

        <label>Colour</label>
        <div class="swatches" id="swatches" role="group" aria-label="Choose colour theme"></div>

        <button type="submit" class="btn primary">Add to Cart</button>
        <button type="button" class="btn" onclick="location.href='mailto:sunnysugarart@gmail.com'">Email Us</button>
        <p class="note">Made to order. Contains egg & gluten. Nut‑free kitchen but traces may exist. Please book ahead for peak seasons.</p>
      </form>
    </aside>
  </div>

  <div id="oops" class="oops" style="display:none"></div>
</div>

<script>
/* =================== 資料 =================== */
<script>
/* =================== 資料 =================== */
const CATALOG = {
  halloween:{
    items:{
      ghosts:{
        title:"Ghost Set",
        price:"A$ 84.90",
        images:[
          "images/halloween-ghosts.jpg",
          "images/halloween-ghosts-2.jpg",
          "images/halloween-ghosts-3.jpg",
          "images/halloween-2.jpg"
        ],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["White","Black","Champagne gold","Copper","Orange"]
      },
      pumpkin:{
        title:"Pumpkin Faces",
        price:"A$ 84.90",
        images:["images/halloween-pumpkin.jpg","images/halloween-3.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK"],
        colours:["Orange","Black","Champagne gold","Copper","White"]
      },
      pumpkinmen:{
        title:"Pumpkin Men",
        price:"A$ 84.90",
        images:["images/halloween-pumpkinmen.jpg","images/halloween-2.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK"],
        colours:["Orange","Black","White"]
      },
      cake:{
        title:"Halloween Cake Set",
        price:"Quote",
        images:["images/halloween-cake.jpg","images/halloween-cake-2.jpg"],
        flavours:["Vanilla Shortbread"],
        packs:["6-inch","8-inch"],
        colours:["Gold","White","Black"]
      },
      drinkme:{
        title:"“Drink Me” Bottles",
        price:"A$ 49.00",
        images:[
          "images/halloween-drink-me.jpg",  // 檔名請用 '-'，避免空白
          "images/halloween-2.jpg"
        ],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK"],
        colours:["White","Gold","Black"]
      }
    }
  },

  christmas:{
    items:{
      "surprise-tree":{
        title:"Surprise Tree",
        price:"A$ 84.90",
        images:["images/christmas-surprise-tree.jpg","images/christmas-surprise-tree-2.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["Assorted","Random","More colours – leave a note"]
      },
      "happy-tree":{
        title:"Happy Tree",
        price:"A$ 84.90",
        images:["images/christmas-happy-tree.jpg","images/christmas.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["Blue gradient","Green gradient","Green","White","Red","Yellow-green gradient","Random","More colours – leave a note"]
      },
      "snowflake":{
        title:"Snowflake",
        price:"A$ 84.90",
        images:["images/christmas-snowflake.jpg","images/christmas-2.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["Blue","Purple","Blue & Purple","Random","More colours – leave a note"]
      },
      "gingerbread":{
        title:"Gingerbread Man",
        price:"A$ 84.90",
        images:["images/christmas-gingerbread.jpg","images/christmas-2.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["Classic","Pastel","Random","More colours – leave a note"]
      },
      "candy-cane":{
        title:"Candy Cane",
        price:"A$ 84.90",
        images:["images/christmas-candy-cane.jpg","images/christmas.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["Red","Green","Red & Green","Red & White","White & Green","Random","More colours – leave a note"]
      },
      "reindeer":{
        title:"Reindeer",
        price:"A$ 84.90",
        images:["images/christmas-reindeer.jpg","images/christmas.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["White","Brown","Random","More colours – leave a note"]
      },
      "snowman":{
        title:"Snowman",
        price:"A$ 84.90",
        images:["images/christmas-snowman.jpg","images/christmas-2.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["Classic","Pastel","Random","More colours – leave a note"]
      },
      "santa-belt":{
        title:"Santa Belt",
        price:"A$ 84.90",
        images:["images/christmas-santa-belt.jpg","images/christmas.jpg"],
        flavours:["Mixture of Vanilla & Chocolate","Signature Chocolate","Vanilla Shortbread"],
        packs:["10 PACK","15 PACK","30 PACK","50 PACK"],
        colours:["Red & Black","Classic","Random","More colours – leave a note"]
      }
    }
  }
};
</script>
/* =================== 工具 =================== */
function getHashParam(name, def=""){
  const m = location.hash.match(new RegExp(name+"=([^&]+)"));
  return m ? decodeURIComponent(m[1]) : def;
}
function colorClass(name=""){
  const n=name.toLowerCase();
  if(n.includes("pink")) return "pink";
  if(n.includes("orange")) return "orange";
  if(n.includes("black")) return "black";
  if(n.includes("white")) return "white";
  if(n.includes("gold") || n.includes("champagne")) return "gold";
  if(n.includes("red")) return "red";
  if(n.includes("green")) return "green";
  if(n.includes("blue")) return "blue";
  if(n.includes("purple")) return "purple";
  if(n.includes("brown")) return "brown";
  if(n.includes("yellow")) return "yellow";
  return "white";
}

/* =================== 渲染 =================== */
function renderFromHash(){
  const cat = getHashParam("cat");
  const itemKey = getHashParam("item");
  const grid   = document.getElementById('grid');
  const oops   = document.getElementById('oops');
  const heroEl = document.getElementById('hero');
  const thumbsEl = document.getElementById('thumbs');
  const titleEl = document.getElementById('title');
  const priceEl = document.getElementById('price');
  const flavourSel = document.getElementById('flavour');
  const packSel = document.getElementById('pack');
  const swatchesEl = document.getElementById('swatches');

  const item = CATALOG[cat]?.items?.[itemKey];

  if(!item){
    grid.style.display='none';
    oops.style.display='block';
    oops.textContent = 'Product not found. Please go back and choose again.';
    return;
  }
  oops.style.display='none';
  grid.style.display='grid';

  titleEl.textContent = item.title || 'Untitled';
  priceEl.textContent = item.price || '';

  // Flavour / Pack
  flavourSel.innerHTML = (item.flavours||[]).map(f=>`<option>${f}</option>`).join('');
  packSel.innerHTML    = (item.packs||[]).map(p=>`<option>${p}</option>`).join('');

  // 色票
  const colours = item.colours && item.colours.length ? item.colours : ["Random"];
  swatchesEl.innerHTML = colours.map((c,i)=>`<button type="button" class="swatch ${colorClass(c)}" data-color="${c}" aria-pressed="${i===0}"></button>`).join('');
  let colorChosen = colours[0];
  swatchesEl.querySelectorAll('.swatch').forEach(btn=>{
    btn.addEventListener('click',()=>{
      swatchesEl.querySelectorAll('.swatch').forEach(b=>b.setAttribute('aria-pressed','false'));
      btn.setAttribute('aria-pressed','true');
      colorChosen = btn.dataset.color;
    });
  });

  // 圖片載入（過濾首頁大圖；失敗自動忽略；全失敗使用佔位）
  const blocked = /(^|\/)(christmas\.jpg|halloween\.jpg)$/i;
  const planned = (item.images||[]).filter(src => !blocked.test(src));
  function loadImg(src){
    return new Promise(res=>{
      const im=new Image();
      im.onload = ()=>res(src);
      im.onerror= ()=>{ console.warn('Image NOT found:', src); res(null); };
      im.src = src;
    });
  }
  Promise.all(planned.map(loadImg)).then(list=>{
    const imgs = list.filter(Boolean);
    if(!imgs.length){ imgs.push('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="900"><rect width="100%" height="100%" fill="%23f5f0e6"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="%23998" font-family="sans-serif" font-size="28">Image coming soon</text></svg>'); }

    let idx = 0;
    const renderStage = ()=>{
      heroEl.src = imgs[idx];
      [...thumbsEl.querySelectorAll('img')].forEach((t,i)=>t.setAttribute('aria-current', i===idx));
    };

    thumbsEl.innerHTML = imgs.map((src,i)=>`<img src="${src}" alt="thumb ${i+1}" ${i===0?'aria-current="true"':''}>`).join('');
    thumbsEl.querySelectorAll('img').forEach((t,i)=>t.addEventListener('click',()=>{idx=i; renderStage();}));
    document.getElementById('prev').onclick = ()=>{idx=(idx-1+imgs.length)%imgs.length; renderStage();};
    document.getElementById('next').onclick = ()=>{idx=(idx+1)%imgs.length; renderStage();};
    renderStage();
  });

  // 表單送出（示範）
  document.getElementById('buy').onsubmit = (e)=>{
    e.preventDefault();
    const data = {
      cat, item: itemKey,
      title: item.title, price: item.price,
      flavour: flavourSel.value, pack: packSel.value, colour: colorChosen
    };
    alert(`Added:\n${data.title}\n${data.flavour} / ${data.pack}\nColour: ${data.colour}\n${data.price}`);
  };
}

renderFromHash();
window.addEventListener('hashchange', renderFromHash);
</script>
</body>
</html>
