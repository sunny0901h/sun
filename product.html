<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sunny Sugar Art｜Product</title>
  <style>
    :root{--bg:#faf9fb;--ink:#1f2328;--muted:#667085;--line:#ececf1;--card:#fff;--shadow:0 10px 30px rgba(10,10,20,.07);--radius:18px;--seg-bd:#c7c1bc;--seg-on:#5b463a;--seg-bg:#fffaf6}
    *{box-sizing:border-box} body{margin:0;font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--ink)}
    .wrap{max-width:1100px;margin:auto;padding:24px}
    .grid{display:grid;grid-template-columns:1.15fr .85fr;gap:28px} @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .gallery{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow)}
    .slider{position:relative;overflow:hidden;border-radius:14px;height:560px;background:#f3f3f6}
    .slides{display:flex;transition:transform .5s ease;height:100%} .slides img{flex:0 0 100%;width:100%;height:560px;object-fit:cover;display:block}
    .nav{position:absolute;top:50%;transform:translateY(-50%);border:0;background:rgba(255,255,255,.85);backdrop-filter:blur(4px);width:44px;height:44px;border-radius:50%;box-shadow:var(--shadow);cursor:pointer}
    .prev{left:10px}.next{right:10px}
    .dots{display:flex;gap:6px;justify-content:center;margin-top:12px}
    .dots button{width:9px;height:9px;border-radius:50%;border:0;background:#d1d5db;cursor:pointer}
    .dots button[aria-current="true"]{background:#333}
    .panel{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:24px;box-shadow:var(--shadow)}
    .badge{display:inline-block;background:#ede9fe;border:1px solid #d9d6fe;padding:2px 10px;border-radius:999px;color:#4b5563;font-size:.85rem}
    h1{margin:.4rem 0 0;font-size:1.8rem} .price{font-weight:800;font-size:1.4rem;margin:6px 0 18px}
    details.acc{border:1px solid var(--line);border-radius:14px;padding:12px;background:#fff} details.acc+details.acc{margin-top:12px} details.acc>summary{cursor:pointer;font-weight:700}
    .group{margin-top:8px;display:flex;flex-wrap:wrap;gap:10px}
    .opt{padding:10px 14px;border:1.5px solid var(--seg-bd);border-radius:12px;background:#fff;cursor:pointer;font-weight:700}
    .opt[aria-pressed="true"]{border-color:var(--seg-on);background:var(--seg-bg)}
    .actions{display:flex;gap:12px;align-items:center;margin-top:18px;flex-wrap:wrap}
    .btn{border:2px solid #2f2a26;border-radius:999px;padding:12px 24px;font-weight:800;background:#fff;color:#2f2a26;cursor:pointer}
    .btn.primary{background:#2f2a26;color:#fff}
    .notes{margin-top:16px;padding:14px 16px;border:1px dashed #e5e7eb;border-radius:12px;background:#fff}
    .errorbar{display:none;padding:10px 14px;background:#fee2e2;color:#991b1b;font-weight:700}
    .errorbar.show{display:block}
  </style>
</head>
<body>
  <div id="errorbar" class="errorbar"></div>

  <div class="wrap" id="app" hidden>
    <div class="grid">
      <section class="gallery" aria-label="product images">
        <div class="slider" id="slider" aria-roledescription="carousel">
          <div class="slides" id="slides"></div>
          <button class="nav prev" aria-label="Prev" id="prev">‹</button>
          <button class="nav next" aria-label="Next" id="next">›</button>
        </div>
        <div class="dots" id="dots" aria-hidden="true"></div>
      </section>

      <aside class="panel">
        <span class="badge">Sunny Sugar Art</span>
        <h1 id="p-title">Product</h1>
        <div class="price" id="p-price">$ —</div>

        <details class="acc" open>
          <summary>Flavour</summary>
          <div class="group" id="flavours"></div>
          <input type="hidden" id="flavourVal">
        </details>

        <details class="acc" open>
          <summary>Pack Size</summary>
          <div class="group" id="packs"></div>
          <input type="hidden" id="packVal">
        </details>

        <div class="actions">
          <button class="btn primary" id="add">Add to Cart</button>
          <button class="btn" id="ask">Send Enquiry</button>
          <small class="help">We’ll confirm details and lead time via email/phone.</small>
        </div>

        <div class="notes">
          <h3>Notes</h3>
          <ul>
            <li>Please order at least 30 days in advance.</li>
            <li>Handmade items may vary slightly in colour.</li>
          </ul>
        </div>
      </aside>
    </div>
  </div>

  <div id="notfound" class="wrap" hidden>
    <h1 style="margin:32px 0 8px">Product not found</h1>
    <p>We couldn’t find this item. Please go back to the <a href="index.html">Shop</a>.</p>
  </div>

  <script>
    function showErr(e){ const bar=document.getElementById('errorbar'); bar.textContent='Script error: '+e; bar.className='errorbar show'; console.error(e); }

    try{
      const PRODUCTS = {
        halloween:{ title:'Halloween Cookies', price:'A$ 59.90 — 199.00', images:['images/halloween.jpg','images/halloween-2.jpg','images/halloween-3.jpg'], flavours:['Mixture of Ginger & Vanilla','Signature Ginger','Vanilla Shortbread'], packs:['10 PACK','15 PACK','30 PACK','50 PACK'] },
        christmas:{ title:'Christmas Gift Box', price:'A$ 69.90 — 219.00', images:['images/christmas.jpg','images/christmas-2.jpg'], flavours:['Mixture of Ginger & Vanilla','Signature Ginger','Vanilla Shortbread'], packs:['10 PACK','15 PACK','30 PACK','50 PACK'] },
        custom:{ title:'Custom Cookies', price:'A$ — (quote)', images:['images/custom.jpg','images/custom-2.jpg'], flavours:['Mixture of Ginger & Vanilla','Signature Ginger','Vanilla Shortbread'], packs:['10 PACK','15 PACK','30 PACK','50 PACK'] },
        baby:{ title:'Baby Shower Cookies', price:'A$ 59.90 — 189.00', images:['images/baby.jpg','images/baby-2.jpg','images/baby-3.jpg'], flavours:['Mixture of Ginger & Vanilla','Signature Ginger','Vanilla Shortbread'], packs:['10 PACK','15 PACK','30 PACK','50 PACK'] },
        meringue:{ title:'Custom Meringue Kisses', price:'A$ —', images:['images/meringue.jpg','images/meringue-2.jpg'], flavours:['Vanilla','Ginger'], packs:['10 PACK','30 PACK','50 PACK'] },
        cake:{ title:'Decorated Cakes', price:'A$ — (quote)', images:['images/cake.jpg','images/cake-2.jpg'], flavours:['Vanilla','Chocolate','Lemon'], packs:['6-inch','8-inch','2-tier'] }
      };

      const m = location.hash.match(/slug=([^&]+)/i);
      const slug = m ? decodeURIComponent(m[1]).trim().toLowerCase() : '';
      const data = PRODUCTS[slug];

      // 如果沒有對應商品，顯示 notfound（不要丟例外）
      if(!data){ document.getElementById('notfound').hidden=false; document.title='Sunny Sugar Art｜Not Found'; return; }

      // 內容顯示
      document.getElementById('app').hidden=false;
      document.title = 'Sunny Sugar Art｜' + data.title;
      document.getElementById('p-title').textContent = data.title;
      document.getElementById('p-price').textContent = data.price;

      // 輪播
      const slidesEl=document.getElementById('slides');
      const dotsEl=document.getElementById('dots');
      const prev=document.getElementById('prev');
      const next=document.getElementById('next');
      let idx=0, imgs=data.images||[];

      function render(){
        slidesEl.innerHTML = imgs.map(src=>`<img src="${src}" alt="${data.title}" loading="lazy">`).join('');
        dotsEl.innerHTML = imgs.map((_,i)=>`<button aria-current="${i===idx}"></button>`).join('');
        update(); bind();
      }
      function update(immediate){
        slidesEl.style.transition= immediate? 'none':'transform .5s ease';
        slidesEl.style.transform=`translateX(${-idx*100}%)`;
        [...dotsEl.children].forEach((b,i)=>b.setAttribute('aria-current', i===idx));
      }
      function bind(){
        [...dotsEl.children].forEach((b,i)=>b.onclick=()=>{idx=i;update(true)});
        prev.onclick=()=>{idx=(idx-1+imgs.length)%imgs.length;update()};
        next.onclick=()=>{idx=(idx+1)%imgs.length;update()};
      }
      let autoplay=null; function start(){ stop(); autoplay=setInterval(()=>{idx=(idx+1)%imgs.length;update()},4000) } function stop(){ if(autoplay){ clearInterval(autoplay); autoplay=null } }
      render(); start();
      slidesEl.addEventListener('mouseenter', stop); slidesEl.addEventListener('mouseleave', start);

      // segmented 選項
      function buildGroup(containerId, values, hiddenId){
        const el=document.getElementById(containerId); const hid=document.getElementById(hiddenId); el.innerHTML='';
        values.forEach((txt,i)=>{const b=document.createElement('button'); b.type='button'; b.className='opt'; b.textContent=txt; b.setAttribute('aria-pressed','false'); b.onclick=()=>{[...el.children].forEach(x=>x.setAttribute('aria-pressed','false')); b.setAttribute('aria-pressed','true'); hid.value=txt;}; el.appendChild(b); if(i===0){b.click()}});
      }
      buildGroup('flavours', data.flavours, 'flavourVal');
      buildGroup('packs', data.packs, 'packVal');

      // demo 按鈕
      document.getElementById('add').onclick=()=>alert('Added! (demo)');
      document.getElementById('ask').onclick=()=>alert('Enquiry sent (demo)');
    }catch(err){ showErr(err); }
  </script>
</body>
</html>
